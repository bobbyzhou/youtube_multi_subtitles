<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body {
      width: 300px;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 14px;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
    }

    .header h1 {
      margin: 0;
      font-size: 18px;
      color: #333;
    }

    .setting-group {
      margin-bottom: 15px;
    }

    .setting-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #555;
    }

    .setting-group select,
    .setting-group input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #2196F3;
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }

    .save-btn {
      width: 100%;
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
      margin-top: 10px;
    }

    .save-btn:hover {
      background-color: #45a049;
    }

    .status {
      text-align: center;
      margin-top: 10px;
      padding: 5px;
      border-radius: 4px;
      font-size: 12px;
    }

    .status.success {
      background-color: #d4edda;
      color: #155724;
    }

    .status.error {
      background-color: #f8d7da;
      color: #721c24;
    }

    .clear-cache-btn:hover {
      background-color: #ff5252 !important;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>YouTube双语字幕</h1>
  </div>

  <div class="setting-group">
    <label for="enabled">启用双语字幕</label>
    <label class="toggle-switch">
      <input type="checkbox" id="enabled" checked>
      <span class="slider"></span>
    </label>
  </div>

  <div class="setting-group">
    <label for="targetLanguage">翻译目标语言</label>
    <select id="targetLanguage">
      <option value="zh-CN">简体中文</option>
      <option value="zh-TW">繁体中文</option>
      <option value="en">English</option>
      <option value="ja">日本語</option>
      <option value="ko">한국어</option>
      <option value="es">Español</option>
      <option value="fr">Français</option>
      <option value="de">Deutsch</option>
      <option value="ru">Русский</option>
    </select>
  </div>

  <div class="setting-group">
    <label for="displayPosition">字幕显示位置</label>
    <select id="displayPosition">
      <option value="bottom">底部</option>
      <option value="top">顶部</option>
      <option value="overlay">覆盖原字幕</option>
    </select>
  </div>

  <div class="setting-group">
    <label for="fontSize">字体大小</label>
    <select id="fontSize">
      <option value="small">小</option>
      <option value="medium" selected>中</option>
      <option value="large">大</option>
      <option value="xlarge">特大</option>
      <option value="xxlarge">超大</option>
      <option value="giant">极大</option>
    </select>
  </div>


  <div class="setting-group">
    <label for="apiPreference">翻译接口选择</label>
    <select id="apiPreference">
      <option value="auto" selected>自动（有 Key 用 v2， 否则免费）</option>
      <option value="v2">只用 v2（需有效 API Key）</option>
      <option value="free">只用免费接口</option>
    </select>
  </div>

  <div class="setting-group">
    <label for="autoClearCacheOnStrategySwitch">切换策略后自动清缓存（仅当前视频/语言）</label>
    <label class="toggle-switch">
      <input type="checkbox" id="autoClearCacheOnStrategySwitch" checked>
      <span class="slider"></span>
    </label>
    <small style="color: #666; font-size: 12px;">避免旧策略缓存影响体验；高级用户可关闭</small>
  </div>

  <div class="setting-group">
    <label for="apiKey">Google Translate API Key</label>
    <input type="password" id="apiKey" placeholder="输入你的API Key">
    <small style="color: #666; font-size: 12px;">用于高质量翻译服务</small>
  </div>

  <div class="setting-group">
    <label for="cacheTime">缓存时间 (小时)</label>
    <select id="cacheTime">
      <option value="1">1小时</option>
      <option value="6">6小时</option>
      <option value="24" selected>24小时</option>
      <option value="168">7天</option>
      <option value="720">30天</option>
    </select>
  </div>

  <div class="setting-group">
    <label for="preTranslate">预翻译模式</label>
    <label class="toggle-switch">
      <input type="checkbox" id="preTranslate" checked>
      <span class="slider"></span>
    </label>
    <small style="color: #666; font-size: 12px;">提前翻译即将出现的字幕</small>
  </div>

  <div class="setting-group">
    <label for="showOriginal">显示原文</label>
    <label class="toggle-switch">
      <input type="checkbox" id="showOriginal" checked>
      <span class="slider"></span>
    </label>
    <small style="color: #666; font-size: 12px;">是否显示原文字幕</small>
  <div class="setting-group">
    <label for="hideYouTubeCaptions">隐藏 YouTube 原生字幕</label>
    <label class="toggle-switch">
      <input type="checkbox" id="hideYouTubeCaptions" checked>
      <span class="slider"></span>
    </label>
    <small style="color: #666; font-size: 12px;">开启后总是隐藏原生字幕（非 overlay 模式也隐藏）</small>
  </div>

  </div>

  <div class="setting-group">
    <label for="animationEnabled">启用动画效果</label>
    <label class="toggle-switch">
      <input type="checkbox" id="animationEnabled" checked>
      <span class="slider"></span>
    </label>
    <small style="color: #666; font-size: 12px;">字幕出现和消失的动画效果</small>
  </div>

  <div class="advanced-settings" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
    <h3 style="margin: 0 0 10px 0; font-size: 14px; color: #333;">高级设置</h3>
    <div class="setting-group">
      <label for="prefetchAggressive">预取强度</label>
      <select id="prefetchAggressive">
        <option value="off">关闭</option>
        <option value="low">低</option>
        <option value="medium" selected>中</option>
        <option value="high">高</option>
      </select>
      <small style="color: #666; font-size: 12px;">控制预取频率，越高越及时但更耗流量</small>
    </div>

    <div class="setting-group">
      <label for="prefetchLookahead">预取数量（条）</label>
      <select id="prefetchLookahead">
        <option value="1">1</option>
        <option value="3">3</option>
        <option value="5" selected>5</option>
        <option value="8">8</option>
        <option value="12">12</option>
      </select>
    </div>

    <div class="setting-group">
      <label for="prefetchIntervalMs">预取节流间隔 (ms)</label>
      <select id="prefetchIntervalMs">
        <option value="120">120</option>
        <option value="200">200</option>
        <option value="300" selected>300</option>
        <option value="600">600</option>
        <option value="1000">1000</option>
      </select>
    </div>

    <div class="setting-group">
      <label for="stableLayout">稳定布局（预留空间）</label>
      <label class="toggle-switch">
        <input type="checkbox" id="stableLayout" checked>
        <span class="slider"></span>
      </label>
      <small style="color: #666; font-size: 12px;">减少字幕出现/消失时的上下跳动</small>
    </div>

    <div class="setting-group">
      <label for="reserveLines">预留行数</label>
      <select id="reserveLines">
        <option value="1">1</option>
        <option value="2" selected>2</option>
        <option value="3">3</option>
        <option value="4">4</option>
      </select>
    </div>

    <div class="setting-group">
      <label for="autoReserveLines">自动调整预留行数</label>
      <label class="toggle-switch">
        <input type="checkbox" id="autoReserveLines" checked>
        <span class="slider"></span>
      </label>
      <small style="color: #666; font-size: 12px;">关闭“显示原文”时，自动减少一行预留高度</small>
    </div>

    <div class="setting-group">
      <label for="showLoadingIndicator">显示“翻译中...”提示</label>
      <label class="toggle-switch">
        <input type="checkbox" id="showLoadingIndicator" checked>
        <span class="slider"></span>
      </label>
      <small style="color: #666; font-size: 12px;">可关闭以进一步减少切换时的视觉噪音</small>
    </div>

    <div class="setting-group">
      <label for="previewDuringIncremental">增量预览（自动字幕时提前显示译文）</label>
      <label class="toggle-switch">
        <input type="checkbox" id="previewDuringIncremental" checked>
        <span class="slider"></span>
      </label>
      <small style="color: #666; font-size: 12px;">ASR 连续吐词时，句中按词/标点边界节流预览一次译文</small>
    </div>



    <div class="setting-group">
      <label for="translationDelay">翻译延迟 (毫秒)</label>
      <select id="translationDelay">
        <option value="0">无延迟</option>
        <option value="50" selected>50ms</option>
        <option value="100">100ms</option>
        <option value="200">200ms</option>
      </select>
      <small style="color: #666; font-size: 12px;">调整翻译触发的延迟时间</small>
    </div>

    <div class="setting-group">
      <button class="clear-cache-btn" id="clearCacheBtn" style="width: 100%; padding: 8px; background-color: #ff6b6b; color: white; border: none; border-radius: 4px; font-size: 12px; cursor: pointer;">
        清除翻译缓存
      </button>
      <small style="color: #666; font-size: 12px;">清除所有已缓存的翻译结果</small>
    </div>
  </div>

  <button class="save-btn" id="saveBtn">保存设置</button>

  <div class="status" id="status" style="display: none;"></div>

  <script src="popup.js"></script>
</body>
</html>
